# Google Java 風格指南

## 1 簡介
本文件為 Google 針對 Java™ 程式語言原始碼之編碼標準的完整定義。當且僅當一個 Java 原始檔遵守此處列出的規則時，該檔案才被視為符合 Google 風格 (Google Style)。

### 1.1 術語說明
除非另有說明，否則本文件中的術語定義如下：
1. 術語 class (類別) 廣義地包含一般類別 (class)、紀錄類別 (record class)、列舉類別 (enum class)、介面 (interface) 或註解類型 (@interface)。
2. 術語 member (成員，指類別的成員) 廣義地包含巢狀類別 (nested class)、欄位 (field)、方法 (method) 或建構子 (constructor)；即除了初始化區塊 (initializers) 之外的所有類別頂層內容。
3. 術語 comment (註解) 總是原本的實作註解 (implementation comments)。我們不使用 "documentation comments" 一詞，而是使用通用術語 "Javadoc"。

## 2 原始檔基礎

### 2.1 檔案名稱
對於包含類別的原始檔，檔名由頂層類別 (top-level class) 的名稱 (區分大小寫) 加上 .java 副檔名組成 (該檔案中應只有這一個頂層類別)。

### 2.2 檔案編碼：UTF-8
原始檔皆以 UTF-8 編碼。

### 2.3 特殊字元
#### 2.3.1 空白字元
除了行終止序列 (line terminator sequence) 之外，ASCII 水平空白字元 (0x20) 是唯一出現在原始檔中任何位置的空白字元。這意味著：
1. 所有其他空白字元在字元 (char) 和字串 (string) 文字常數以及文字區塊 (text blocks) 中都要進行跳脫 (escaped)。
2. Tab 字元不用於縮排。

#### 2.3.2 特殊跳脫序列
對於任何具有特殊跳脫序列 (\b, \t, \n, \f, \r, \s, \", \' 和 \\) 的字元，應使用該序列，而不是對應的八進位 (例如 \012) 或 Unicode (例如 \u000a) 跳脫字元。

#### 2.3.3 非 ASCII 字元
對於其餘的非 ASCII 字元，可以使用實際的 Unicode 字元 (例如 ∞) 或等效的 Unicode 跳脫字元 (例如 \u221e)。選擇哪種方式取決於何者能使程式碼更易於閱讀和理解。

## 3 原始檔結構
一個普通的原始檔依序包含以下部分：
1. 授權或版權資訊 (如果有的話)
2. Package (套件) 宣告
3. Imports (匯入)
4. 恰好一個頂層類別 (Top-level class) 宣告

每個存在的部分之間都以恰好一行空行分隔。

### 3.1 授權或版權資訊 (如果有的話)
如果檔案中需要包含授權或版權資訊，則應放在此處。

### 3.2 Package (套件) 宣告
Package 宣告不換行 (line-wrapped)。行寬限制 (Column limit) 不適用於 package 宣告。

### 3.3 Imports (匯入)
#### 3.3.1 不使用萬用字元 (Wildcard) 匯入
不使用萬用字元 ("on-demand") 匯入，無論是靜態還是非靜態。

#### 3.3.2 不換行
Imports 不換行。行寬限制不適用於 imports。

#### 3.3.3 排序和間距
Imports 的排序如下：
1. 所有靜態匯入 (static imports) 為一組。
2. 所有非靜態匯入 (non-static imports) 為一組。
如果同時存在靜態和非靜態匯入，則兩組之間以一行空行分隔。匯入語句之間沒有其他空行。

### 3.4 類別 (Class) 宣告
#### 3.4.1 恰好一個頂層類別宣告
每個頂層類別都位於其專屬的原始檔中。

#### 3.4.2 類別內容的排序
類別成員和初始化區塊的順序對可學習性有很大影響。重要的是每個類別都使用某種邏輯順序，如果有人詢問，維護者能夠解釋清楚。

##### 3.4.2.1 Overloads (多載)：永不拆分
共用相同名稱的類別方法應出現在一個連續的群組中，中間不插入其他成員。

### 3.5 模組 (Module) 宣告
模組指令 (Module directives) 的排序如下：
1. requires
2. exports
3. opens
4. uses
5. provides

## 4 格式化 (Formatting)

### 4.1 大括號 (Braces)
#### 4.1.1 使用可選的大括號
大括號用於 if, else, for, do 和 while 語句，即使主體是空的或只包含一個語句。

#### 4.1.2 非空區塊：K & R 風格
非空區塊和區塊狀結構的大括號遵循 Kernighan 和 Ritchie 風格：
- 左大括號前不換行。
- 左大括號後換行。
- 右大括號前換行。
- 僅當右大括號終止一個語句或終止方法、建構子或命名類別的主體時，才在右大括號後換行。

#### 4.1.3 空區塊：可簡潔
空區塊或區塊狀結構可以是 K & R 風格。或者，可以在打開後立即關閉 ({})，除非它是多區塊語句的一部分 (直接包含多個區塊的語句：if/else 或 try/catch/finally)。

### 4.2 區塊縮排：+2 個空格
每次打開一個新的區塊或區塊狀結構時，縮排增加兩個空格。當區塊結束時，縮排返回到上一級縮排層級。

### 4.3 每個語句一行
每個語句後都要換行。

### 4.4 行寬限制 (Column limit)：100
Java 程式碼的行寬限制為 100 個字元。

### 4.5 換行 (Line-wrapping)
#### 4.5.1 在哪裡斷行
換行的主要指導原則是：傾向於在較高的語法層級斷行。
1. 當在非賦值運算子處斷行時，斷行出現在符號之前。
2. 當在賦值運算子處斷行時，斷行通常出現在符號之後。
3. 方法、建構子或紀錄類別名稱與其後的左括號 (() 保持連接。
4. 逗號 (,) 與其前面的標記保持連接。

#### 4.5.2 續行縮排至少 +4 個空格
換行時，第一行之後的每一行 (每個續行) 至少比原始行縮排 +4 個空格。

### 4.6 空白 (Whitespace)
#### 4.6.1 垂直空白 (空行)
以下情況總是會出現單行空行：
1. 在類別的連續成員或初始化區塊之間：欄位、建構子、方法、巢狀類別、靜態初始化區塊和實體初始化區塊。
2. 本文件其他部分要求時。

#### 4.6.2 水平空白
除了語言或其他風格規則要求的地方，以及在文字常數、註解和 Javadoc 之外，單個 ASCII 空格僅出現在以下地方：
1. 分隔任何關鍵字 (如 if, for 或 catch) 與其後的左括號 (()。
2. 分隔任何關鍵字 (如 else 或 catch) 與其前的右大括號 (})。
3. 在任何左大括號 ({) 之前，有少數例外。
4. 在任何二元或三元運算子的兩側。
5. 在 , : ; 或轉型 (cast) 的右括號 ()) 之後。
6. 在任何內容與開始註解的雙斜線 (//) 之間。

### 4.7 分組括號：建議使用
僅當作者和審閱者都同意沒有括號也不會導致程式碼被誤解，或者括號不會使程式碼更易讀時，才省略可選的分組括號。

### 4.8 特定結構
#### 4.8.1 Enum 類別
跟在 enum 常數後的逗號之後，換行是可選的。

#### 4.8.2 變數宣告
每個變數宣告 (欄位或區域變數) 只宣告一個變數：不使用如 int a, b; 這樣的宣告。

#### 4.8.3 陣列 (Arrays)
任何陣列初始化都可以選擇格式化為 "區塊狀結構"。
方括號是類型的一部分，而不是變數的一部分：使用 String[] args，而不是 String args[]。

#### 4.8.4 Switch 語句
Switch 表達式必須是新式 switch (new-style switches)。
縮排：+2 個空格。

#### 4.8.5 註解 (Annotations)
應用於類別、package 或模組宣告的註解直接出現在文件區塊之後，每個註解獨佔一行。

#### 4.8.6 註解 (Comments)
區塊註解 (Block comments) 與周圍的程式碼縮排在同一層級。

#### 4.8.7 修飾符 (Modifiers)
類別和成員的修飾符 (如果存在) 按照 Java 語言規範建議的順序出現：
public protected private abstract default static final sealed non-sealed transient volatile synchronized native strictfp

#### 4.8.8 數字文字常數 (Numeric Literals)
long 類型的整數文字常數使用大寫 L 後綴，絕不使用小寫 (以避免與數字 1 混淆)。

#### 4.8.9 文字區塊 (Text Blocks)
文字區塊的開頭 """ 總是在新的一行。

## 5 命名 (Naming)

### 5.1 所有識別字的共同規則
識別字僅使用 ASCII 字母和數字，以及在少數情況下使用底線。

### 5.2 依識別字類型的規則
- Package 名稱：全小寫，連續單字直接連接 (com.example.deepspace)。
- 類別名稱：大駝峰式命名 (UpperCamelCase)。
- 方法名稱：小駝峰式命名 (lowerCamelCase)。
- 常數名稱：全大寫蛇形命名 (UPPER_SNAKE_CASE)。
- 非常數欄位名稱：小駝峰式命名 (lowerCamelCase)。
- 參數名稱：小駝峰式命名 (lowerCamelCase)。
- 區域變數名稱：小駝峰式命名 (lowerCamelCase)。
- 類型變數名稱：單個大寫字母，可選後跟單個數字；或類別命名形式後跟大寫字母 T。

### 5.3 駝峰式命名 (Camel case)：定義
建議：如果任何單字在通用用法中已經具有傳統的駝峰式外觀，則將其拆分為其組成部分 (例如，"AdWords" 變為 "ad words")。

## 6 程式設計實務

### 6.1 @Override：總是使用
只要合法，方法就會標記 @Override 註解。

### 6.2 捕獲的例外 (Caught exceptions)：不忽略
對捕獲的例外不做任何處理通常是不正確的。

### 6.3 靜態成員：使用類別限定
當必須限定對靜態類別成員的參考時，應使用該類別的名稱進行限定，而不是使用該類別類型的參考或表達式。

### 6.4 Finalizers：不使用
不要覆寫 Object.finalize。

## 7 Javadoc

### 7.1 格式化
#### 7.1.1 一般形式
Javadoc 區塊的基本格式如下例所示：
```java
/**
 * Multiple lines of Javadoc text are written here,
 * wrapped normally...
 */
public int method(String p1) { ... }
```

#### 7.1.2 段落
段落之間以及段落與區塊標籤組之間會出現一行空行——即僅包含對齊的前導星號 (*) 的行。

#### 7.1.3 區塊標籤 (Block tags)
使用的任何標準 "區塊標籤" 按順序出現：@param, @return, @throws, @deprecated。

### 7.2 摘要片段
每個 Javadoc 區塊都以一個簡短的摘要片段開始。這是一個片段——名詞片語或動詞片語，而不是完整的句子。

### 7.3 Javadoc 使用時機
至少，每個可見的類別、成員或紀錄組件都應有 Javadoc。
例外：
- 不言自明的成員 (例如，簡單的 getFoo)。
- 覆寫 (Overrides)。
